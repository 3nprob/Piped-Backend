server {
  listen ${YTPROXY_PORT};
  server_name ${YTPROXY_SERVER_NAME}
  access_log off;

  location ~ (/videoplayback|/api/v4/) {
    proxy_pass ${YTPROXY_ADDRESS};
    proxy_set_header Host "${YTPROXY_SERVER_NAME}";
    include snippets/ytproxy.conf;
    add_header Cache-Control private always;
    proxy_hide_header Access-Control-Allow-Origin;
  }

  location / {
    proxy_pass ${YTPROXY_ADDRESS};
    proxy_set_header Host "${YTPROXY_SERVER_NAME}";
    include snippets/ytproxy.conf;
    add_header Cache-Control "public, max-age=604800";
    proxy_hide_header Access-Control-Allow-Origin;
  }
}

server {
  listen ${API_PORT};
  server_name ${API_SERVER_NAME}
  access_log off;

  location / {
    proxy_pass ${API_ADDRESS};
    proxy_set_header Host "${API_SERVER_NAME}";
    # proxy_set_header Host $host;
    # proxy_http_version 1.1;
    # proxy_set_header Connection "";
  }
}

server {
  listen ${WEB_PORT};
  server_name ${WEB_SERVER_NAME}
  access_log off;

  location / {
    root /var/www;
    try_files $uri $uri/ /index.html =404;
    sendfile on;
    aio threads=default;
  }
}
